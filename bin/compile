#!/bin/sh

indent() {
  sed -u 's/^/       /'
}

echo "-----> Installing yt-dlc"
cd $1
mkdir -p "vendor"
cd "vendor"
mkdir -p ./yt-dlc/bin/
cd ./yt-dlc/bin/
wget $(curl -s https://api.github.com/repos/blackjack4494/yt-dlc/releases/latest \
| grep -e "browser_download_url.*yt-dlc" \
| cut -d : -f 2,3 \
| tr -d \" \
| grep -e "yt-dlc$") 
chmod a+rx yt-dlc
echo "Adding to PATH" | indent
PROFILE="$1/.profile.d/yt-dlc.sh"
mkdir -p "$1/.profile.d/"
touch $PROFILE
echo 'export PATH="$PATH:$HOME/vendor/yt-dlc/bin"' >> $PROFILE
